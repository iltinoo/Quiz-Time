<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Quiz: HauptstÃ¤dte & Einwohner</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
    .hidden { display: none; }
    input[type=text] { padding: 0.5rem; margin-bottom: 1rem; width: 100%; }
    button { padding: 0.5rem 1rem; margin-top: 1rem; }
    ul { list-style: none; padding-left: 0; }
    li { padding: 0.5rem; cursor: pointer; border: 1px solid #ddd; margin-bottom: 5px; }
    li:hover { background: #f0f0f0; }
    .correct { background-color: #c8f7c5; }
    .incorrect { background-color: #f7c5c5; }
  </style>
</head>
<body>

<h1>Geografie-Quiz</h1>

<div id="login">
  <h2>Benutzername eingeben</h2>
  <input type="text" id="username" placeholder="z.â€¯B. Alex123" />
  <button onclick="login()">Anmelden</button>
</div>

<div id="quiz" class="hidden">
  <h2 id="welcome"></h2>
  <div id="questionContainer">
    <h3 id="question"></h3>
    <ul id="choices"></ul>
    <button onclick="nextQuestion()">NÃ¤chste Frage</button>
  </div>
  <p id="progress"></p>
  <button onclick="showWrongAnswers()">Falsch beantwortete Fragen wiederholen</button>
</div>

<script>
const quizData = [
  { question: "Was ist die Hauptstadt von Spanien?", choices: ["Madrid", "Barcelona", "Valencia", "Sevilla"], answer: "Madrid" },
  { question: "Wie viele Einwohner hat Deutschland (ca.)?", choices: ["83 Mio", "75 Mio", "60 Mio", "90 Mio"], answer: "83 Mio" },
  { question: "Was ist die Hauptstadt von Portugal?", choices: ["Lissabon", "Porto", "Braga", "Faro"], answer: "Lissabon" },
  { question: "Wie viele Einwohner hat Frankreich (ca.)?", choices: ["67 Mio", "61 Mio", "82 Mio", "75 Mio"], answer: "67 Mio" },
  // ... hier folgen viele weitere Fragen (siehe unten)
];

while (quizData.length < 100) {
  const sample = [
    { q: "Was ist die Hauptstadt von", a: "Hauptstadt" },
    { q: "Wie viele Einwohner hat", a: "Einwohnerzahl" }
  ];
  const countries = [
    ["Italien", "Rom", "59 Mio"],
    ["Schweiz", "Bern", "8.6 Mio"],
    ["Polen", "Warschau", "38 Mio"],
    ["Niederlande", "Amsterdam", "17 Mio"],
    ["Belgien", "BrÃ¼ssel", "11.5 Mio"],
    ["Griechenland", "Athen", "10.5 Mio"],
    ["Tschechien", "Prag", "10.7 Mio"],
    ["Ungarn", "Budapest", "9.6 Mio"],
    ["TÃ¼rkei", "Ankara", "85 Mio"],
    ["Kanada", "Ottawa", "39 Mio"],
    ["USA", "Washington, D.C.", "333 Mio"],
    ["Brasilien", "BrasÃ­lia", "213 Mio"],
    ["Argentinien", "Buenos Aires", "46 Mio"],
    ["Japan", "Tokio", "125 Mio"],
    ["China", "Peking", "1.4 Mrd"],
    ["Russland", "Moskau", "146 Mio"]
  ];
  const rand = countries[Math.floor(Math.random() * countries.length)];
  const topic = sample[Math.floor(Math.random() * sample.length)];

  quizData.push({
    question: `${topic.q} ${rand[0]}?`,
    choices: topic.a === "Hauptstadt"
      ? shuffle([rand[1], "Paris", "Berlin", "Madrid"])
      : shuffle([rand[2], "100 Mio", "50 Mio", "20 Mio"]),
    answer: topic.a === "Hauptstadt" ? rand[1] : rand[2]
  });
}

let currentUser = null;
let currentQuestionIndex = 0;
let userAnswers = {};

function login() {
  const username = document.getElementById("username").value.trim();
  if (!username) return alert("Bitte gib einen Benutzernamen ein.");
  currentUser = username;
  const saved = localStorage.getItem("quiz_" + username);
  userAnswers = saved ? JSON.parse(saved) : {};
  document.getElementById("login").classList.add("hidden");
  document.getElementById("quiz").classList.remove("hidden");
  document.getElementById("welcome").innerText = `Willkommen, ${username}!`;
  loadQuestion();
}

function loadQuestion() {
  if (currentQuestionIndex >= quizData.length) {
    document.getElementById("questionContainer").innerHTML = "<h3>ðŸŽ‰ Quiz abgeschlossen!</h3>";
    return;
  }

  const q = quizData[currentQuestionIndex];
  document.getElementById("question").innerText = q.question;
  const ul = document.getElementById("choices");
  ul.innerHTML = "";
  q.choices.forEach(choice => {
    const li = document.createElement("li");
    li.textContent = choice;
    li.onclick = () => handleAnswer(choice, li, q.answer);
    ul.appendChild(li);
  });

  document.getElementById("progress").innerText = `Frage ${currentQuestionIndex + 1} von ${quizData.length}`;
}

function handleAnswer(choice, element, correctAnswer) {
  const qText = quizData[currentQuestionIndex].question;
  userAnswers[qText] = { userAnswer: choice, correctAnswer, correct: choice === correctAnswer };
  saveAnswers();

  [...document.querySelectorAll("li")].forEach(li => li.onclick = null);
  element.classList.add(choice === correctAnswer ? "correct" : "incorrect");
}

function saveAnswers() {
  localStorage.setItem("quiz_" + currentUser, JSON.stringify(userAnswers));
}

function nextQuestion() {
  currentQuestionIndex++;
  loadQuestion();
}

function showWrongAnswers() {
  const wrong = Object.entries(userAnswers).filter(([_, v]) => !v.correct);
  if (wrong.length === 0) return alert("ðŸŽ‰ Keine Fehler â€“ gut gemacht!");
  const questions = wrong.map(([q, v]) => `${q}\nDeine Antwort: ${v.userAnswer}\nRichtige Antwort: ${v.correctAnswer}`).join("\n\n");
  alert("Diese Fragen solltest du nochmal Ã¼ben:\n\n" + questions);
}

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>
